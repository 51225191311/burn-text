<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æŸ¥çœ‹ç§˜å¯†</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            text-align: center;
            padding: 20px;
            background-color: #2f3542; /* æ·±è‰²èƒŒæ™¯ï¼Œæ›´æœ‰ç¥ç§˜æ„Ÿ */
            color: white; /* ç™½å­— */
        }
        .container {
            background: #57606f;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        #content {
            font-size: 18px;
            white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œç¬¦ */
            margin: 20px 0;
            color: #7bed9f; /* è§å…‰ç»¿æ–‡å­— */
        }
        #status {
            color: #ff6b81;
            font-weight: bold;
        }
    </style>
</head>
<body>
<div class="container">
    <h2>ğŸ”’ æœºå¯†ä¿¡æ¯</h2>
    <div id="status">æ­£åœ¨è§£å¯†æ•°æ®...</div>
    <div id="content"></div>
</div>

<script>
    // é¡µé¢åŠ è½½å®Œæˆåç«‹å³æ‰§è¡Œ
    window.onload = async function() {
        // 1. ä»æµè§ˆå™¨åœ°å€æ åˆ†æ URL
        // å‡è®¾åœ°å€æ˜¯ http://localhost:8080/view/ID123?key=ABC
        const pathParts = window.location.pathname.split('/');
        const id = pathParts[pathParts.length - 1]; // æ‹¿åˆ° "ID123"

        // æ‹¿åˆ° "?key=ABC" é‡Œçš„ ABC
        const params = new URLSearchParams(window.location.search);
        const key = params.get("key");

        if (!id || !key) {
            document.getElementById("status").innerText = "âŒ æ— æ•ˆçš„é“¾æ¥";
            return;
        }

        // 2. æ‹¿ç€ ID å’Œ Key å»æ‰¾ Go åç«¯è¦æ•°æ®
        // æ³¨æ„ï¼šè¿™é‡Œæˆ‘ä»¬è¯·æ±‚çš„æ˜¯ API æ¥å£ /api/view/
        try {
            const response = await fetch(`/api/view/${id}?key=${key}`);
            const data = await response.json();

            if (response.ok) {
                document.getElementById("status").innerText = "âœ… é˜…åå³ç„šå·²ç”Ÿæ•ˆï¼Œæ•°æ®å·²é”€æ¯";
                document.getElementById("content").innerText = data.data; // æ˜¾ç¤ºè§£å¯†åçš„æ˜æ–‡
            } else {
                document.getElementById("status").innerText = "âš ï¸ " + data.error;
            }
        } catch (e) {
            document.getElementById("status").innerText = "ç½‘ç»œé”™è¯¯";
        }
    };
</script>
</body>
</html>